// This file is automatically generated. DO NOT EDIT!
// Generated from: codegen/Sources/Schema/Methods/Execute.swift

import Foundation
import SmithereenAPIInternals
import Hammond

/// Runs your JavaScript-like script on the server to make multiple API calls
/// and post-process their results.
/// 
/// You can use this, for example, to retrieve different data in one go to
/// display a complex screen, like a user’s profile, or to make several API
/// calls that depend on each other’s results.
/// You can make up to 25 API calls in one execute.
/// 
/// The server will compile your code into an intermediate representation and
/// cache that. Thus, it is more efficient to pass extra parameters and retrieve
/// them using the `Args.param_name` syntax rather than dynamically generate
/// the code itself.
public struct Execute<Args: Encodable, Result: Decodable>: SmithereenAPIRequest, Encodable {
	public var code: String
	public var args: Args
	public var captchaAnswer: CaptchaAnswer?

	public init(
		code: String,
		args: Args,
	) {
		self.code = code
		self.args = args
	}

	private enum CodingKeys: String, CodingKey {
		case code
	}
	public func encode(to encoder: any Encoder) throws {
		var container = encoder.container(keyedBy: CodingKeys.self)
		try container.encode(self.code, forKey: .code)
		try self.args.encode(to: encoder)
	}
	public var path: String {
		"/api/method/execute"
	}
	public static var method: HTTPMethod {
		.post
	}
	public var encodableBody: Self? {
		self
	}
	public typealias Result = Result
}
extension Execute: Equatable where Args: Equatable {
}
extension Execute: Hashable where Args: Hashable {
}
extension Execute: Sendable where Args: Sendable {
}