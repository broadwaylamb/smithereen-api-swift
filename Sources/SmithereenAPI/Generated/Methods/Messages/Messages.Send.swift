// This file is automatically generated. DO NOT EDIT!
// Generated from: codegen/Sources/Schema/Methods/Messages.swift

import Foundation
import SmithereenAPIInternals
import Hammond
extension Messages {

	/// Sends a new message.
	/// 
	/// - Note: This method requires the following permissions: `messages`.
	public struct Send: SmithereenAPIRequest, Hashable, Encodable, Sendable {

		/// A list of user identifiers for recipients.
		public var to: [UserID]

		/// The subject line of the message.
		public var subject: String?

		/// The text of the message.
		/// **Required** if there are no ``attachments``.
		/// This parameter supports formatted text, the format is
		/// determined by the ``textFormat`` parameter.
		public var body: String?

		/// The format of the message text passed in ``body``.
		/// By default, the user’s preference is used.
		public var textFormat: TextFormat?

		/// An array representing the media attachments to be added to this message.
		/// **Required** if there is no ``body``.
		@EncodeAsJSONString
		public var attachments: [AttachmentToCreate]?

		/// If this is not empty, make the content of the message hidden
		/// by default, requiring a click to reveal.
		/// This text will be shown instead of the content.
		public var contentWarning: String?

		/// A unique identifier used to prevent accidental double-posting
		/// on unreliable connections.
		/// If ``Messages/Send`` was previously called with this
		/// ``guid`` in the last hour, no new message will be created,
		/// the ID of that previously created message will be returned
		/// instead. Recommended for mobile apps.
		public var guid: UUID?
		public var captchaAnswer: CaptchaAnswer?

		/// - parameters:
		///   - to: A list of user identifiers for recipients.
		///   - subject: The subject line of the message.
		///   - body: The text of the message.
		///     **Required** if there are no ``attachments``.
		///     This parameter supports formatted text, the format is
		///     determined by the ``textFormat`` parameter.
		///   - textFormat: The format of the message text passed in ``body``.
		///     By default, the user’s preference is used.
		///   - attachments: An array representing the media attachments to be added to this message.
		///     **Required** if there is no ``body``.
		///   - contentWarning: If this is not empty, make the content of the message hidden
		///     by default, requiring a click to reveal.
		///     This text will be shown instead of the content.
		///   - guid: A unique identifier used to prevent accidental double-posting
		///     on unreliable connections.
		///     If ``Messages/Send`` was previously called with this
		///     ``guid`` in the last hour, no new message will be created,
		///     the ID of that previously created message will be returned
		///     instead. Recommended for mobile apps.
		public init(
			to: [UserID],
			subject: String? = nil,
			body: String? = nil,
			textFormat: TextFormat? = nil,
			attachments: [AttachmentToCreate]? = nil,
			contentWarning: String? = nil,
			guid: UUID? = nil,
		) {
			self.to = to
			self.subject = subject
			self.body = body
			self.textFormat = textFormat
			self.attachments = attachments
			self.contentWarning = contentWarning
			self.guid = guid
		}

		private enum CodingKeys: String, CodingKey {
			case to
			case subject
			case body
			case textFormat = "text_format"
			case attachments
			case contentWarning = "content_warning"
			case guid
		}
		public var path: String {
			"/api/method/messages.send"
		}
		public static var method: HTTPMethod {
			.post
		}
		public var encodableBody: Self? {
			self
		}
		public typealias Result = MessageID
	}
}