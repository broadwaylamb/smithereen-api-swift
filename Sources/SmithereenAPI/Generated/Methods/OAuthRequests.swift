// This file is automatically generated. DO NOT EDIT!
// Generated from: codegen/Sources/Schema/Methods/OAuth.swift

import Foundation
import SmithereenAPIInternals
import Hammond
extension OAuth {

	public struct AccessTokenResponse: Hashable, Codable, Sendable {
		public var accessToken: AccessToken
		public var userID: UserID

		/// In how many seconds this access token expires.
		public var expiresIn: Double?

		/// - parameters:
		///   - expiresIn: In how many seconds this access token expires.
		public init(
			accessToken: AccessToken,
			userID: UserID,
			expiresIn: Double? = nil,
		) {
			self.accessToken = accessToken
			self.userID = userID
			self.expiresIn = expiresIn
		}

		private enum CodingKeys: String, CodingKey {
			case accessToken = "access_token"
			case userID = "user_id"
			case expiresIn = "expires_in"
		}
	}
}
extension OAuth {

	public struct TokenError: Hashable, Codable, Sendable, Error {

		public struct Code: Hashable, RawRepresentable, CaseIterable, Codable, Sendable {
			public var rawValue: String
			public init(rawValue: String) {
				self.rawValue = rawValue
			}

			public static let accessDenied = Self(rawValue: "access_denied")
			public static let invalidRequest = Self(rawValue: "invalid_request")
			public static let invalidGrant = Self(rawValue: "invalid_grant")
			public static let unsupportedGrantType = Self(rawValue: "unsupported_grant_type")

			public static let allCases: [Code] = [
				.accessDenied,
				.invalidRequest,
				.invalidGrant,
				.unsupportedGrantType,
			]
		}
		public var code: Code

		/// A localized error description suitable for display in the UI.
		public var errorDescription: String?

		/// - parameters:
		///   - errorDescription: A localized error description suitable for display in the UI.
		public init(
			code: Code,
			errorDescription: String? = nil,
		) {
			self.code = code
			self.errorDescription = errorDescription
		}

		private enum CodingKeys: String, CodingKey {
			case code = "error"
			case errorDescription = "error_description"
		}
	}
}
extension OAuth {

	public struct ExchangeAuthorizationCodeForAccessToken: SmithereenOAuthTokenRequest, Hashable, Encodable, Sendable {
		private let grantType: String = "authorization_code"

		/// The OAuth authorization code.
		public var code: AuthorizationCode

		/// The redirect URI you used for obtaining the authorization code.
		@URLAsString
		public var redirectUri: URL

		/// Your application ID.
		@URLAsString
		public var clientID: URL

		/// If using PKCE, the code verifier string.
		public var codeVerifier: String?

		/// - parameters:
		///   - code: The OAuth authorization code.
		///   - redirectUri: The redirect URI you used for obtaining the authorization code.
		///   - clientID: Your application ID.
		///   - codeVerifier: If using PKCE, the code verifier string.
		public init(
			code: AuthorizationCode,
			redirectUri: URL,
			clientID: URL,
			codeVerifier: String? = nil,
		) {
			self.code = code
			self.redirectUri = redirectUri
			self.clientID = clientID
			self.codeVerifier = codeVerifier
		}

		private enum CodingKeys: String, CodingKey {
			case grantType = "grant_type"
			case code
			case redirectUri = "redirect_uri"
			case clientID = "client_id"
			case codeVerifier = "code_verifier"
		}
		public var path: String {
			"/oauth/token"
		}
		public static var method: HTTPMethod {
			.post
		}
		public var encodableBody: Self? {
			self
		}
	}
}
extension OAuth {

	/// Receive an access token with complete access to a user account
	/// using their email/username and password.
	/// This is intended for client apps, to provide a more streamlined
	/// user experience, and for apps running on platforms that can't
	/// load or render modern web pages.
	public struct PasswordGrant: SmithereenOAuthTokenRequest, Hashable, Encodable, Sendable {
		private let grantType: String = "password"

		/// Your application ID.
		@URLAsString
		public var clientID: URL

		/// The email or username.
		public var username: String

		/// The user's password.
		public var password: String

		/// - parameters:
		///   - clientID: Your application ID.
		///   - username: The email or username.
		///   - password: The user's password.
		public init(
			clientID: URL,
			username: String,
			password: String,
		) {
			self.clientID = clientID
			self.username = username
			self.password = password
		}

		private enum CodingKeys: String, CodingKey {
			case grantType = "grant_type"
			case clientID = "client_id"
			case username
			case password
		}
		public var path: String {
			"/oauth/token"
		}
		public static var method: HTTPMethod {
			.post
		}
		public var encodableBody: Self? {
			self
		}
	}
}