// This file is automatically generated. DO NOT EDIT!
// Generated from: codegen/Sources/Schema/Methods/Server.swift

import Foundation
import SmithereenAPIInternals
import Hammond
extension Server {

	/// Submits a report about potentially harmful content or behavior for review
	/// by the server staff.
	public struct Report: SmithereenAPIRequest, Hashable, Encodable, Sendable {

		/// The identifier of the user or group being reported.
		public var ownerID: ActorID

		/// The reason for the report.
		public var reason: Reason

		public enum Reason: Hashable, Encodable, Sendable {

			/// Spam
			case spam

			/// The actor violates some server rules.
			/// Only available when there are rules defined on the server.
			/// At least one rule identifier must be specified.
			case rules([ServerRuleID])

			/// Illegal content or activities.
			case illegal

			/// Anything that doesnâ€™t fit into the above categories.
			case other

			private enum CodingKeys: String, CodingKey {
				case type = "reason"
				case ruleIDs = "rule_ids"
			}
			public func encode(to encoder: any Encoder) throws {
				var container = encoder.container(keyedBy: CodingKeys.self)
				let tag: String
				switch self {
				case .spam:
					tag = "spam"
				case .rules(let ruleIDs):
					tag = "rules"
					try container.encode(ruleIDs, forKey: .ruleIDs)
				case .illegal:
					tag = "illegal"
				case .other:
					tag = "other"
				}
				try container.encode(tag, forKey: .type)
			}
		}

		/// Any content to be attached to the report.
		/// ``ownerID`` must be a user and the content must be authored
		/// by that user.
		@EncodeAsJSONString
		public var content: [ReportedContent]?

		public enum ReportedContent: Hashable, Encodable, Sendable {
			case wallPost(WallPostID)
			case wallComment(WallPostID)
			case photoComment(PhotoCommentID)
			case topicComment(TopicCommentID)
			case message(MessageID)
			case photo(PhotoID)

			private enum CodingKeys: String, CodingKey {
				case type
				case id
			}
			public func encode(to encoder: any Encoder) throws {
				var container = encoder.container(keyedBy: CodingKeys.self)
				let tag: String
				switch self {
				case .wallPost(let id):
					tag = "wall_post"
					try container.encodeToString(id, forKey: .id)
				case .wallComment(let id):
					tag = "wall_comment"
					try container.encodeToString(id, forKey: .id)
				case .photoComment(let id):
					tag = "comment"
					try container.encode(id, forKey: .id)
				case .topicComment(let id):
					tag = "comment"
					try container.encode(id, forKey: .id)
				case .message(let id):
					tag = "message"
					try container.encode(id, forKey: .id)
				case .photo(let id):
					tag = "photo"
					try container.encode(id, forKey: .id)
				}
				try container.encode(tag, forKey: .type)
			}
		}

		/// If ``ownerID`` refers to an actor on another server, whether to
		/// forward (anonymously) the report to that server.
		/// 
		/// By default `false`.
		public var forward: Bool?

		/// An optional comment for the server staff.
		public var comment: String?

		/// - parameters:
		///   - ownerID: The identifier of the user or group being reported.
		///   - reason: The reason for the report.
		///   - content: Any content to be attached to the report.
		///     ``ownerID`` must be a user and the content must be authored
		///     by that user.
		///   - forward: If ``ownerID`` refers to an actor on another server, whether to
		///     forward (anonymously) the report to that server.
		///     
		///     By default `false`.
		///   - comment: An optional comment for the server staff.
		public init(
			ownerID: ActorID,
			reason: Reason,
			content: [ReportedContent]? = nil,
			forward: Bool? = nil,
			comment: String? = nil,
		) {
			self.ownerID = ownerID
			self.reason = reason
			self.content = content
			self.forward = forward
			self.comment = comment
		}

		private enum CodingKeys: String, CodingKey {
			case ownerID = "owner_id"
			case content
			case forward
			case comment
		}
		public func encode(to encoder: any Encoder) throws {
			var container = encoder.container(keyedBy: CodingKeys.self)
			try container.encode(self.ownerID, forKey: .ownerID)
			try self.reason.encode(to: encoder)
			try container.encodeIfPresent(self.content, forKey: .content)
			try container.encodeIfPresent(self.forward, forKey: .forward)
			try container.encodeIfPresent(self.comment, forKey: .comment)
		}
		public var path: String {
			"/api/method/server.report"
		}
		public static var method: HTTPMethod {
			.post
		}
		public var encodableBody: Self? {
			self
		}
		public typealias Result = ()
	}
}