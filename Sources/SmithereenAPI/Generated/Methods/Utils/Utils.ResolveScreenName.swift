// This file is automatically generated. DO NOT EDIT!
// Generated from: codegen/Sources/Schema/Methods/UtilsMethods.swift

import Foundation
import SmithereenAPIInternals
import Hammond
extension Utils {

	/// Returns the user, group, or app ID by its screen name (username).
	/// 
	/// This method only works with actors that are already present
	/// in the serverâ€™s database. If you need to load a remote actor that
	/// the server may not know about, use ``LoadRemoteObject`` instead.
	public struct ResolveScreenName: SmithereenAPIRequest, Hashable, Encodable, Sendable {

		/// The username or `username@domain` to resolve.
		public var screenName: String

		public enum Result: Hashable, Codable, Sendable {
			case user(UserID)
			case group(GroupID)
			case application(ApplicationID)

			private enum CodingKeys: String, CodingKey {
				case type
				case id
			}

			public init(from decoder: Decoder) throws {
				let container = try decoder.container(keyedBy: CodingKeys.self)
				let type = try container.decode(String.self, forKey: .type)
				switch type {
				case "user":
					let id = try container.decode(UserID.self, forKey: .id)
					self = .user(id)
				case "group":
					let id = try container.decode(GroupID.self, forKey: .id)
					self = .group(id)
				case "application":
					let id = try container.decode(ApplicationID.self, forKey: .id)
					self = .application(id)
				default:
					throw DecodingError.dataCorruptedError(
						forKey: .type,
						in: container,
						debugDescription: "Unknown payload type \(String(reflecting: type))",
					)
				}
			}
			public func encode(to encoder: any Encoder) throws {
				var container = encoder.container(keyedBy: CodingKeys.self)
				let tag: String
				switch self {
				case .user(let id):
					tag = "user"
					try container.encode(id, forKey: .id)
				case .group(let id):
					tag = "group"
					try container.encode(id, forKey: .id)
				case .application(let id):
					tag = "application"
					try container.encode(id, forKey: .id)
				}
				try container.encode(tag, forKey: .type)
			}
		}
		public var captchaAnswer: CaptchaAnswer?

		/// - parameters:
		///   - screenName: The username or `username@domain` to resolve.
		public init(screenName: String) {
			self.screenName = screenName
		}

		private enum CodingKeys: String, CodingKey {
			case screenName = "screen_name"
		}
		public var path: String {
			"/api/method/utils.resolveScreenName"
		}
		public static var method: HTTPMethod {
			.post
		}
		public var encodableBody: Self? {
			self
		}
	}
}