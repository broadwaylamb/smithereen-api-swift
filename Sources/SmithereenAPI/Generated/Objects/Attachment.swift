// This file is automatically generated. DO NOT EDIT!
// Generated from: codegen/Sources/Schema/Objects/Attachment.swift

import Foundation
import SmithereenAPIInternals

/// A media attachment to a wall post, a comment, or a private message.
public enum Attachment: Hashable, Codable, Sendable {

	/// The attachment is a photo.
	case photo(Photo)

	/// The attachment is a graffiti. Only exists on top-level wall posts.
	case graffiti(Graffiti)

	/// The attachment is a video
	case video(Video)

	/// The attachment is an audio
	case audio(Audio)

	/// The attachment is a poll.
	case poll(Poll)

	private enum CodingKeys: String, CodingKey {
		case type
		case photo
		case graffiti
		case video
		case audio
		case poll
	}

	public init(from decoder: Decoder) throws {
		let container = try decoder.container(keyedBy: CodingKeys.self)
		let type = try container.decode(String.self, forKey: .type)
		switch type {
		case "photo":
			let photo = try container.decode(Photo.self, forKey: .photo)
			self = .photo(photo)
		case "graffiti":
			let graffiti = try container.decode(Graffiti.self, forKey: .graffiti)
			self = .graffiti(graffiti)
		case "video":
			let video = try container.decode(Video.self, forKey: .video)
			self = .video(video)
		case "audio":
			let audio = try container.decode(Audio.self, forKey: .audio)
			self = .audio(audio)
		case "poll":
			let poll = try container.decode(Poll.self, forKey: .poll)
			self = .poll(poll)
		default:
			throw DecodingError.dataCorruptedError(
				forKey: .type,
				in: container,
				debugDescription: "Unknown payload type \(String(reflecting: type))",
			)
		}
	}
	public func encode(to encoder: any Encoder) throws {
		var container = encoder.container(keyedBy: CodingKeys.self)
		let tag: String
		switch self {
		case .photo(let photo):
			tag = "photo"
			try container.encode(photo, forKey: .photo)
		case .graffiti(let graffiti):
			tag = "graffiti"
			try container.encode(graffiti, forKey: .graffiti)
		case .video(let video):
			tag = "video"
			try container.encode(video, forKey: .video)
		case .audio(let audio):
			tag = "audio"
			try container.encode(audio, forKey: .audio)
		case .poll(let poll):
			tag = "poll"
			try container.encode(poll, forKey: .poll)
		}
		try container.encode(tag, forKey: .type)
	}
}