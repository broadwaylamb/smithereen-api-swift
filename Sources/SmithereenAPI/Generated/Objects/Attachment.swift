// This file is automatically generated. DO NOT EDIT!

import Foundation
import SmithereenAPIInternals

/// A media attachment to a wall post, a comment, or a private message.
public enum Attachment: Hashable, Codable, Sendable {

	/// The attachment is a photo.
	case photo(Photo)

	/// The attachment is a graffiti. Only exists on top-level wall posts.
	case graffiti(Graffiti)

	/// The attachment is a video
	case video(Video)

	/// The attachment is an audio
	case audio(Audio)

	/// The attachment is a poll.
	case poll(Poll)

	private enum CodingKeys: String, CodingKey {
		case type
		case photo
		case graffiti
		case video
		case audio
		case poll
	}

	public init(from decoder: Decoder) throws {
		let container = try decoder.container(keyedBy: CodingKeys.self)
		let type = try container.decode(String.self, forKey: .type)
		switch type {
		case "photo":
			self = .photo(try container.decode(Photo.self, forKey: .photo))
		case "graffiti":
			self = .graffiti(try container.decode(Graffiti.self, forKey: .graffiti))
		case "video":
			self = .video(try container.decode(Video.self, forKey: .video))
		case "audio":
			self = .audio(try container.decode(Audio.self, forKey: .audio))
		case "poll":
			self = .poll(try container.decode(Poll.self, forKey: .poll))
		default:
			throw DecodingError.dataCorruptedError(
				forKey: .type,
				in: container,
				debugDescription: "Unknown payload type",
			)
		}
	}
	public func encode(to encoder: any Encoder) throws {
		var container = encoder.container(keyedBy: CodingKeys.self)
		let tag: String
		switch self {
		case .photo(let payload):
			tag = "photo"
			try container.encode(payload, forKey: .photo)
		case .graffiti(let payload):
			tag = "graffiti"
			try container.encode(payload, forKey: .graffiti)
		case .video(let payload):
			tag = "video"
			try container.encode(payload, forKey: .video)
		case .audio(let payload):
			tag = "audio"
			try container.encode(payload, forKey: .audio)
		case .poll(let payload):
			tag = "poll"
			try container.encode(payload, forKey: .poll)
		}
		try container.encode(tag, forKey: .type)
	}
}